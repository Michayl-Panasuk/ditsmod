# @ts-stack/mod

`@ts-stack/mod` написаний на TypeScript, він є Node.js веб-фреймворком, в назві якого слово `mod` означає хорошу модульність.
Ця модульність забезпечується, у великій мірі, завдяки системі [Dependency Injection][1].

## Зміст

- [Встановлення](#встановлення)

## Встановлення

Мінімальний базовий набір для роботи застосунку `@ts-stack/mod` має репозиторій [mod-seed][2].
Клонуйте його та встановіть залежності:

```bash
git clone git@github.com:ts-stack/mod-seed.git my-app
cd my-app
npm i
```

Окрім цього, можете проглянути більше прикладів у теці [examples][4].

## Запуск

```bash
npm start
```

## Деякі особливості `@ts-stack/mod`

Рідний Node.js веб-сервер надає мінімальну функціональність для прийому HTTP-запитів та відправки HTTP-відповідей. Він не надає систем роутінгу, парсингу тіла запиту, логування, обробки помилок, тестування. І оскільки в реальних застосунках уся перерахована функціональність є базовою, виникає потреба у додатковому веб-фреймворку. З іншого боку, якщо все-таки певний веб-фреймворк надає перераховані системи, то йому також необхідно забезпечити гнучкий механізм заміни цих систем на інші системи, що будуть більш доречними чи більш зручними для конкретного розробника.

Із коробки, `@ts-stack/mod` надає базовий роутинг та парсинг, але по великому рахунку, головною його особливістю є інтеграція рідного Node.js веб-сервера з модулем [Dependency Injection][1] (скорочено - DI), що зокрема надає і той згаданий гнучкий механізм заміни. Завдяки цьому механізму, дуже суттєво спрощується тестування.

Окрім цього, DI забезпечує ієрархічну модульність. Це означає, що ви можете оголошувати сервіси з областю видимості: або на рівні усього застосунку, або на рівні конкретного модуля, або на рівні конкретного контролера.
1. Якщо сервіс оголошено на рівні застосунку, то сінглтон цього сервісу буде створено один єдиний раз при старті застосунку. Наприклад, таким сервісом може бути MySql.
2. Сервіс на рівні модуля може створюватись декілька разів, якщо його буде імпортовано в декілька різних модулів, і в кожному із цих модулів буде свій окремий сінглтон. Наприклад, таким сервісом може бути сервіс надання конфігурації.
3. Сервіс на рівні конкретного контролера буде створюватись при кожному створенні інстансу цього контролера, тобто при кожному запиті (по відповідному маршруті). Наприклад, таким сервісом може бути парсер тіла запиту.

### Зауваження

- Сервіс, оголошений на рівні застосунку, не повинен запитувати у своїх конструкторах сервіс,
оголошений на нижчому рівні (модуля чи запиту), оскільки він створюються один раз - при ініціалізації застосунку. Аналогічно сервіс, оголошений на рівні модуля не повинен запитувати у своєму конструкторі сервіс, оглошений на рівні запиту.
- Щоб оголосити сервіси у глобальному просторі на будь-якому рівні (на рівні застосунку, модуля чи запиту),
спочатку потрібно:
  - або оголосити сервіс у кореневому модулі на потрібному рівні
  - або імпортувати модуль із потрібним сервісом у кореневий модуль
Після чого необхідно еспортувати ці сервіси, або модулі із цими сервісами.


[1]: https://github.com/ts-stack/di
[2]: https://github.com/ts-stack/mod-seed
[3]: https://github.com/ts-stack/mod
[4]: https://github.com/ts-stack/mod/tree/master/examples
